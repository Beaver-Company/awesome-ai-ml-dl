FROM adoptopenjdk/openjdk9 AS jdkBuilder

FROM ubuntu:16.04
COPY --from=jdkBuilder /opt/java/openjdk/ /opt/java/openjdk/

ENV JAVA_HOME=/opt/java/openjdk/
ENV PATH=${JAVA_HOME}/bin:${PATH}
RUN echo "JDK9, Linux only: We are enabling JVMCI flags (enabling Graal as Tier-2 compiler)"
RUN echo "Please check docs for higher versions of JDK and other platforms"
ENV JAVA_OPTS="-XX:+UnlockExperimentalVMOptions -XX:+EnableJVMCI -XX:+UseJVMCICompiler"

RUN echo "PATH=${PATH}"
RUN echo "JAVA_OPTS=${JAVA_OPTS}"

RUN java --version
RUN javac --version

RUN apt-get update &&     \
    apt-get install -qy   \
    	unzip             \
    	curl              \
		python-pip        \ 
		python-setuptools \
	--no-install-recommends && rm -r /var/lib/apt/lists/

COPY install-java-kernel.sh install-java-kernel.sh

RUN python --version
RUN pip --version

RUN pip install --upgrade pip 
RUN pip install jupyter

RUN ./install-java-kernel.sh

EXPOSE 8888

COPY runJuPyteRLocal.sh runJuPyteRLocal.sh
WORKDIR jupyter-notebooks
ENTRYPOINT ["./../runJuPyteRLocal.sh"]